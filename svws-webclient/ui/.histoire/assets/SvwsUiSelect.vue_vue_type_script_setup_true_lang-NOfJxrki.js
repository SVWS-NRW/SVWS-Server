import{d as ue,p,q as ie,s as u,aA as ve,av as A,aB as q,aH as de,c as w,f as E,b as K,i as g,e as re,aQ as ce,n as fe,aw as i,aJ as v,u as C,aR as me,aF as pe,aK as Ie,F as ye,az as U,aL as we,aM as he,aN as be,aO as ge,aP as xe,o as r}from"./index-Ypxb2S-y.js";import{_ as Be}from"./SvwsUiDropdownList.vue_vue_type_script_setup_true_lang-CoMw6jt4.js";const Fe={key:1,role:"button",class:"svws-dropdown-icon",tabindex:"-1"},ke={key:0,class:"icon i-ri-expand-up-down-line svws-ui-select--icon"},Ce={key:1,class:"icon i-ri-expand-up-down-fill svws-ui-select--icon"},Le=ue({__name:"SvwsUiSelect",props:{label:{default:""},title:{default:""},autocomplete:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},statistics:{type:Boolean,default:!1},danger:{type:Boolean,default:!1},items:{},itemText:{},emptyText:{type:Function,default:()=>""},itemSort:{type:Function,default:(h,T)=>0},itemFilter:{type:Function,default:h=>h},modelValue:{},useNull:{type:Boolean,default:!1},headless:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},required:{type:Boolean},indeterminate:{type:Boolean,default:!1},highlightItem:{default:void 0},autofocus:{type:Boolean,default:!1},focusClassContent:{type:Boolean,default:!1},focusClassSubNav:{type:Boolean,default:!1},noItemsText:{default:void 0}},emits:["update:modelValue"],setup(h,{expose:T,emit:z}){const a=h,P=z,t=p(),o=p(!1),c=p(),V=p(!1),f=p(""),L=me(),N=p(!1);ie(()=>N.value=!0);function D(){V.value=!0}function O(){V.value=!1,B()}const j=u(()=>o.value&&a.autocomplete?f.value:H());function H(){return s.value===null||s.value===void 0?a.emptyText():a.itemText(s.value)}function J(e){a.autocomplete&&(t.value===void 0||t.value===null)&&document.hasFocus()&&c.value!==null&&document.activeElement===c.value&&m();const l=t.value===void 0||t.value===null?void 0:d.value.at(t.value.activeItemIndex);f.value=e??"",a.autocomplete&&U(()=>{if(t.value!==void 0&&t.value!==null){let I=0;if(l!==void 0){const y=d.value.findIndex(k=>k===l);y>=0&&(I=y)}else if(s.value!==null&&s.value!==void 0){const y=d.value.findIndex(k=>k===s.value);y>=0&&(I=y)}t.value.activeItemIndex=I}})}const n=ve(a.modelValue);A(()=>a.modelValue,e=>S(q(e),!0),{immediate:!1});function S(e,l){e==null&&(n.value===null||n.value===void 0)||n.value!==e&&(n.value=e,l||P("update:modelValue",n.value),a.indeterminate===!0&&(n.value=void 0))}const s=u({get:()=>n.value,set:e=>S(e,!1)}),Q=u(()=>{const e=new Set;return n.value!==null&&n.value!==void 0&&e.add(q(n.value)),e}),$=u(()=>s.value!==null&&s.value!==void 0);function M(e){s.value=e,a.autocomplete&&(f.value=""),B(),x()}function G(){s.value=a.useNull?null:void 0,x()}function W(e){e===!0?s.value=a.modelValue:s.value=a.useNull?null:void 0;const l=c.value;l==null||l.input.blur()}const b=u(()=>{let e;return Array.isArray(a.items)?e=a.items:a.items instanceof Map?e=[...a.items.values()]:e=[...a.items],e.sort(a.itemSort)});A(b,e=>{for(const l of e)if(l===n.value)return;n.value=void 0});const d=u(()=>a.autocomplete?s.value!==null&&s.value!==void 0&&a.itemText(s.value)===f.value?b.value:a.itemFilter(b.value,f.value):b.value);function x(){const e=c.value;e==null||e.input.focus()}function R(){o.value?B():m()}function m(){x(),o.value=!0,U(()=>{t.value===void 0||t.value===null||(s.value!==null&&s.value!==void 0?t.value.activeItemIndex=d.value.findIndex(e=>e===s.value):t.value.activeItemIndex=0,t.value.itemRefs[t.value.activeItemIndex]!==void 0&&t.value.itemRefs[t.value.activeItemIndex].scrollIntoView())})}function B(){t.value!==void 0&&t.value!==null&&(t.value.activeItemIndex=-1),o.value=!1}function F(){t.value===void 0||t.value===null||t.value.activeItemIndex<0||M(d.value[t.value.activeItemIndex])}function X(){if(!o.value||t.value===void 0||t.value===null)return m();const e=d.value.length;t.value.activeItemIndex<e-1?t.value.activeItemIndex++:t.value.activeItemIndex=0,t.value.itemRefs[t.value.activeItemIndex].scrollIntoView()}function Y(){if(!o.value||t.value===void 0||t.value===null)return m();const e=d.value.length;t.value.activeItemIndex===0?t.value.activeItemIndex=e-1:t.value.activeItemIndex>=1&&t.value.activeItemIndex--,t.value.itemRefs[t.value.activeItemIndex].scrollIntoView()}function Z(){o.value===!1&&m()}function _(){a.autocomplete||(o.value?F():m())}function ee(){a.autocomplete&&t.value!==void 0&&t.value!==null&&(t.value.activeItemIndex=0,F())}const{x:te,y:ae,strategy:le}=de(c,t,{placement:"bottom",middleware:[he(),be(),ge(2),xe({apply({rects:e,elements:l}){Object.assign(l.floating.style,{width:`${e.reference.width}px`})}})],whileElementsMounted:we}),se=u(()=>`${ae.value}px`),ne=u(()=>`${te.value}px`),oe=u(()=>n.value);return T({content:oe,reset:W}),(e,l)=>{const I=ce;return r(),w(ye,null,[E("div",pe({class:["svws-ui-select",{"svws-open":o.value,"svws-has-value":$.value,"svws-headless":e.headless,"svws-statistik":e.statistics,"svws-danger":e.danger,"svws-disabled":e.disabled,"svws-removable":e.removable,"svws-readonly":e.readonly}]},e.$attrs),[re(I,{ref_key:"inputEl",ref:c,"model-value":j.value,readonly:!e.autocomplete||e.readonly,"is-select-input":!e.readonly,placeholder:e.label||e.title,statistics:e.statistics,headless:e.headless,disabled:e.disabled,required:e.required,role:"combobox","aria-label":e.label||e.title,"aria-expanded":o.value,"aria-haspopup":"listbox","aria-autocomplete":"list","aria-controls":o.value?C(L):null,"aria-activedescendant":t.value&&t.value.activeItemIndex>-1?`${C(L)}-${t.value.activeItemIndex}`:null,"onUpdate:modelValue":J,onClick:v(R,["stop"]),onFocus:D,onBlur:O,onKeyup:[l[0]||(l[0]=i(v(()=>{},["prevent"]),["down"])),l[1]||(l[1]=i(v(()=>{},["prevent"]),["up"]))],onKeydown:[i(v(X,["prevent"]),["down"]),i(v(Y,["prevent"]),["up"]),i(v(F,["prevent"]),["enter"]),i(Z,["backspace"]),i(v(R,["prevent"]),["esc"]),i(v(_,["prevent"]),["space"]),i(ee,["tab"])],focus:e.autofocus,class:fe({contentFocusField:e.focusClassContent,subNavigationFocusField:e.focusClassSubNav})},null,8,["model-value","readonly","is-select-input","placeholder","statistics","headless","disabled","required","aria-label","aria-expanded","aria-controls","aria-activedescendant","onKeydown","focus","class"]),e.removable&&$.value&&!e.readonly?(r(),w("button",{key:0,role:"button",onClick:v(G,["stop"]),class:"svws-remove"},l[2]||(l[2]=[E("span",{class:"icon i-ri-close-line svws-ui-select--icon"},null,-1)]))):g("",!0),e.readonly?g("",!0):(r(),w("button",Fe,[e.headless?(r(),w("span",ke)):(r(),w("span",Ce))]))],16),N.value?(r(),K(Ie,{key:0,to:"body"},[o.value?(r(),K(Be,{key:0,statistics:e.statistics,"filtered-list":d.value,"item-text":e.itemText,strategy:C(le),"floating-left":ne.value,"floating-top":se.value,"selected-item-list":Q.value,"select-item":M,ref_key:"refList",ref:t,"search-text":f.value,"highlight-item":e.highlightItem,"no-items-text":e.noItemsText},null,8,["statistics","filtered-list","item-text","strategy","floating-left","floating-top","selected-item-list","search-text","highlight-item","no-items-text"])):g("",!0)])):g("",!0)],64)}}});export{Le as _};
