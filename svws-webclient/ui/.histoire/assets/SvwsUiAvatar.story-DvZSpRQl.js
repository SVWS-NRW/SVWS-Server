import{_ as q}from"./Story.vue_vue_type_script_setup_true_lang-Ce6KAgbj.js";import{_ as T}from"./Variant.vue_vue_type_script_setup_true_lang-taQgJtpF.js";import{d as V,p as s,q as W,s as G,v as J,c as p,i as u,f as l,b as c,j as K,w as r,n as U,F as D,t as P,o as t,e as $,u as F}from"./index-Ypxb2S-y.js";import{l as R}from"./helper-C553TKur.js";const Q="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='124'%20height='122.643'%20viewBox='0%200%20124%20122.643'%3e%3c/svg%3e",X={key:0,tabindex:"0",class:"avatar--edit"},Y={key:1,class:"avatar--capture-control"},Z={key:0},ee=["src","alt"],ae=["src","alt"],le=V({__name:"SvwsUiAvatar",props:{src:{default:""},alt:{default:""},upload:{type:Boolean,default:!1},capture:{type:Boolean,default:!1}},emits:["image:captured","image:base64"],setup(j,{emit:A}){const n=A,_=s(!1),y=s(!1);W(async()=>{const e=await navigator.mediaDevices.enumerateDevices();for(const a of e)a.kind==="videoinput"&&(_.value=!0)});const h=s(null),o=s(null),k=s(null);function z(){y.value=!y.value,!y.value&&(n("image:base64",null),n("image:captured",null))}function L(){var e;o.value!==null?o.value=null:(e=h.value)==null||e.click()}function w(){d.value?d.value=null:H()}async function x(){var e;f.value?(n("image:captured",d.value),n("image:base64",((e=g.value)==null?void 0:e.toDataURL("image/jpeg",.75).split(",").pop())??null),E()):await N()}function M(e){const a=e.target;if(a.files===null)return;k.value=a.files[0],n("image:captured",k.value);const i=new FileReader;i.onload=I=>{var S;typeof((S=I.target)==null?void 0:S.result)=="string"?(o.value=I.target.result,n("image:base64",I.target.result.split(",").pop()??null)):(o.value=null,n("image:base64",null))},i.readAsDataURL(k.value)}const f=s(!1),d=s(null),b=s(""),m=s(),g=s(null),C=s(),B={video:{width:320},facingMode:"user"},v=G(()=>d.value!==null?URL.createObjectURL(d.value):null);async function N(){d.value=null,f.value=!0;try{C.value=await navigator.mediaDevices.getUserMedia(B),m.value&&(m.value.srcObject=C.value)}catch(e){console.log(e),b.value=e.message}}function E(){var e;(e=C.value)==null||e.getTracks().forEach(a=>a.stop()),d.value=null,f.value=!1}function H(){var e;m.value===void 0||g.value===null||(g.value.width=B.video.width,g.value.height=m.value.videoHeight/(m.value.videoWidth/B.video.width),(e=g.value.getContext("2d"))==null||e.drawImage(m.value,0,0),g.value.toBlob(a=>d.value=a))}J(()=>E());function O(e){e.target.src=Q}return(e,a)=>{const i=K;return t(),p("div",{class:U(["svws-ui-avatar",{"is-capturing":f.value}])},[e.capture||e.upload||e.src.length>0?(t(),p("div",X,[a[3]||(a[3]=l("span",{class:"avatar--edit-trigger"},[l("span",{class:"icon i-ri-camera-line w-full h-full opacity-50"})],-1)),e.src&&e.src.split(",").length>1?(t(),c(i,{key:0,type:"icon",onClick:z,tabindex:"0",title:"Bild löschen"},{default:r(()=>[l("span",{class:U(["icon i-ri-delete-bin-line",{"icon-ui-caution":y.value}])},null,2)]),_:1})):u("",!0),e.upload&&o.value===null&&e.src.split(",").length<2?(t(),c(i,{key:1,type:"icon",onClick:L,tabindex:"0",title:"Bild hochladen"},{default:r(()=>[l("input",{class:"hidden",ref_key:"fileInputEl",ref:h,type:"file",accept:"image/*",onChange:M},null,544),a[0]||(a[0]=l("span",{class:"icon i-ri-upload-2-line"},null,-1))]),_:1,__:[0]})):u("",!0),e.capture&&v.value===null&&_.value?(t(),c(i,{key:2,type:"icon",onClick:x,tabindex:"0",title:"Aufnahme starten"},{default:r(()=>a[1]||(a[1]=[l("span",{class:"icon i-ri-camera-fill"},null,-1)])),_:1,__:[1]})):u("",!0),e.capture&&f.value&&v.value!==null?(t(),c(i,{key:3,type:"icon",onClick:w,tabindex:"0",title:"Aufnahme löschen"},{default:r(()=>a[2]||(a[2]=[l("span",{class:"icon i-ri-delete-bin-line"},null,-1)])),_:1,__:[2]})):u("",!0)])):u("",!0),f.value?(t(),p("div",Y,[v.value!==null?(t(),c(i,{key:0,type:"icon",onClick:w,tabindex:"0",title:"Neue Aufnahme"},{default:r(()=>a[4]||(a[4]=[l("span",{class:"icon i-ri-refresh-line"},null,-1)])),_:1,__:[4]})):u("",!0),v.value===null?(t(),c(i,{key:1,type:"icon",onClick:E,tabindex:"0",title:"Aufnahme abbrechen"},{default:r(()=>a[5]||(a[5]=[l("span",{class:"icon i-ri-camera-off-line"},null,-1)])),_:1,__:[5]})):u("",!0),v.value===null?(t(),c(i,{key:2,type:"primary",onClick:w,tabindex:"0",title:"Bild aufnehmen"},{default:r(()=>a[6]||(a[6]=[l("span",{class:"icon i-ri-fullscreen-line"},null,-1),l("span",null,"Bild aufnehmen",-1)])),_:1,__:[6]})):u("",!0),v.value?(t(),c(i,{key:3,type:"primary",onClick:x,tabindex:"0",title:"Bild speichern"},{default:r(()=>a[7]||(a[7]=[l("span",null,"Bild speichern",-1),l("span",{class:"icon i-ri-check-line"},null,-1)])),_:1,__:[7]})):u("",!0)])):u("",!0),l("div",{class:U(["avatar",{"avatar--has-image":o.value}])},[f.value?(t(),p(D,{key:0},[b.value?(t(),p("span",Z,P(b.value),1)):(t(),p(D,{key:1},[l("video",{playsinline:"",ref_key:"videoEl",ref:m,autoplay:"",id:"video"},null,512),l("canvas",{ref_key:"canvasEl",ref:g,id:"canvas",class:"hidden"},null,512),v.value!==null?(t(),p("img",{key:0,src:v.value,alt:e.alt},null,8,ee)):u("",!0)],64))],64)):(t(),p(D,{key:1},[a[8]||(a[8]=l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[l("path",{d:"M20 22h-2v-2a3 3 0 0 0-3-3H9a3 3 0 0 0-3 3v2H4v-2a5 5 0 0 1 5-5h6a5 5 0 0 1 5 5v2zm-8-9a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"})],-1)),l("img",{src:e.src,alt:e.alt,onError:O},null,40,ae)],64))],2)],2)}}}),te={class:"p-4"},ne={class:"w-20"},re=V({__name:"SvwsUiAvatar.story",setup(j){return(A,n)=>{const _=le,y=T,h=q;return t(),c(h,{title:"Avatar",id:"svws-ui-avatar",icon:"ri:user-line",layout:{type:"single",iframe:!1}},{default:r(()=>[$(y,{title:"Default",id:"Default"},{default:r(()=>[l("div",te,[l("div",ne,[$(_,{"onImage:captured":n[0]||(n[0]=o=>F(R)("Image captured",o)),"onImage:uploaded":n[1]||(n[1]=o=>F(R)("Image Uploaded",o))})])])]),_:1})]),_:1})}}});export{re as default};
